@server = http://localhost:4004
@username = incident.support@tester.sap.com
@password = initial

### ğŸ”’ SQL INJECTION DEMO (matches your current services.js)
# =====================================================
# Methods implemented in services.js:
#   - concat  â†’ âŒ vulnerable: interpolates customerID into SQL string
#   - tagged  â†’ âŒ vulnerable: (parenthesized tagged template) helper returns raw SQL string (still injectable)
#   - safe    â†’ âœ… SECURE: parameterized query (WHERE ID = ?) + [customerID]
# =====================================================


### ============================================
### PART A â€” VULNERABLE (method=concat)
### ============================================

### âœ… Test A1: Legitimate Request (concat) â†’ expect 1 row
GET {{server}}/odata/v4/admin/fetchCustomer
Content-Type: application/json
Authorization: Basic {{username}}:{{password}}

{
  "customerID": "1004100",
  "method": "concat"
}

### ğŸš¨ Test A2: True-clause injection (concat)
### Action: Inject malicious payload ' OR '1'='1 (always true)
### Expected: Returns ALL customer records
### Result: Full database exposure vulnerability

GET {{server}}/odata/v4/admin/fetchCustomer
Content-Type: application/json
Authorization: Basic {{username}}:{{password}}

{
  "customerID": "1004100' OR '1'='1",
  "method": "concat"
}

### ============================================
### PART B â€” VULNERABLE (method=tagged) in your services.js
### ============================================

### âœ… Test B1: Legitimate Request (tagged) â†’ expect 1 row
GET {{server}}/odata/v4/admin/fetchCustomer
Content-Type: application/json
Authorization: Basic {{username}}:{{password}}

{
  "customerID": "1004100",
  "method": "tagged"
}

### ğŸš¨ Test B2: True-clause injection (tagged) â†’ may return many/all rows
GET {{server}}/odata/v4/admin/fetchCustomer
Content-Type: application/json
Authorization: Basic {{username}}:{{password}}

{
  "customerID": "1004100' OR '1'='1",
  "method": "tagged"
}


### ============================================
### PART C â€” SECURE (method=safe)
### ============================================

### âœ… Test C1: Legitimate Request (safe) â†’ expect 1 row
GET {{server}}/odata/v4/admin/fetchCustomer
Content-Type: application/json
Authorization: Basic {{username}}:{{password}}

{
  "customerID": "1004100",
  "method": "safe"
}

### ğŸ›¡ï¸ Test C2: Injection attempt (safe) â†’ expect 0 rows (treated as literal parameter)
GET {{server}}/odata/v4/admin/fetchCustomer
Content-Type: application/json
Authorization: Basic {{username}}:{{password}}

{
  "customerID": "1004100' OR '1'='1",
  "method": "safe"
}

### ğŸ›¡ï¸ Test C3: Multi-statement attempt (safe) â†’ expect 0 rows (treated as literal parameter)
GET {{server}}/odata/v4/admin/fetchCustomer
Content-Type: application/json
Authorization: Basic {{username}}:{{password}}

{
  "customerID": "1004100'; DELETE FROM sap_capire_incidents_Customers;--",
  "method": "safe"
}
